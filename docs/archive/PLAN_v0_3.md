# LIMBOPET 실행 계획 v0.3 (수익화/커스터마이징/마켓플레이스 포함)

## 이번 문서의 목적

- v0.2가 “초보자 온보딩 + 펫=비서 확장” 중심이었다면, v0.3는 **지금의 MVP를 작게 유지하면서도** 나중에 커질 때(UGC/마켓/커스텀) **갈아엎지 않게** 만드는 설계 결정을 정리한다.
- 결론: **지능 비용(BYOK)은 유저가 부담**, 플랫폼은 **월드/기억/규칙 + 꾸미기 + 거래**로 수익을 만든다.

## 지금 상태(2026-02-03 기준)

- E2E(포스트그레스 포함) 실행은 **Docker 데몬이 켜져 있어야** 가능.
- 캐릭터 이미지/에셋은 **아직 없음**(현재는 `avatar_url` 같은 “링크 기반” 프로필만).
- MVP는 “다마고치 루프 + 이벤트 로그 + 오늘의 림보룸 요약(Job) + 로컬 브레인 러너”까지.

---

## 제품 원칙(수익화 포함)

1) **펫의 삶은 서버 규칙이 진실** (state engine)
2) **LLM은 말/글만 쓴다** (서버는 LLM 호출 X)
3) **유저 키는 로컬/유저 프록시 우선** (BYOK-first)
4) **커스터마이징은 ‘능력’이 아니라 ‘표현’** (pay-to-win 금지)
5) **마켓은 “안전/권리/정산”이 제품의 일부** (운영 없는 마켓은 독)

---

## 수익화 모델(현실적 + BYOK 친화)

### 1) 구독(가장 먼저)

- **펫 슬롯 추가**: 기본 1펫, 구독으로 N펫(예: 3/10)
- **메모리 보관/림보룸 확장**: 기본 7일, 구독으로 30/365일
- **리플레이/하이라이트**: “주간 하이라이트/연간 회고” 자동 생성(Job)
- **길드/커뮤니티 확장(후반)**: 길드 창고, 퀘스트 커스텀, 이벤트 운영권

> BYOK이므로 “토큰/사용량 과금”은 원칙적으로 하지 않되, 플랫폼 리소스(저장/검색/피드)는 구독으로 과금.

### 2) 코스메틱(초보자도 이해 쉬움)

- 펫 꾸미기: **아바타 프레임/배경/뱃지/말풍선 스킨/프로필 테마**
- 림보룸 꾸미기: 방 테마(색/텍스처), “기억 카드” 템플릿
- 커뮤니티: 닉네임 스타일/이모지 스탬프/반응 스킨

### 3) UGC 마켓플레이스(후반, 큰 수익원)

- 크리에이터가 **에셋 팩** 판매(스킨/테마/스탬프)
- 플랫폼은 **거래 수수료 + 프로모션 슬롯**으로 수익
- 핵심은 “업로드→검수→판매→정산” 파이프라인

---

## 커스터마이징 시스템 설계(갈아엎지 않게)

### 0) “이미지 없어도 되는” 단계부터

- 1단계(지금): `display_name/description/avatar_url`만.
- 2단계: **Cosmetic Slot** 도입(이미지 파일 없어도 가능한 텍스트/색 테마)
  - 예: `profile_theme = { primaryColor, accentColor, badge }`
- 3단계: 이미지 기반 에셋(정적 이미지/SVG/레이어)

### 1) Appearance = “장착 상태”로 모델링

- 펫은 `appearance`를 가진다(서버가 truth).
- `appearance`는 “슬롯→아이템” 매핑:
  - `avatar_frame`, `background`, `badge`, `speech_bubble`, `limbo_room_theme` …
- 이렇게 하면:
  - 기본 무료 아이템 제공 가능
  - 인벤토리/장착/마켓이 자연스럽게 확장

### 2) 에셋 포맷(권장)

- MVP: **SVG(레이어 가능) + PNG 썸네일** 조합
- 룸 테마: 컬러 토큰 + 배경 패턴(타일 PNG)
- 말풍선: 9-slice 스타일(테두리/배경 분리)

---

## 마켓플레이스(UGC) 설계(후반)

### 1) 업로드/검수/배포 파이프라인

1) 업로드(크리에이터) → 임시 저장
2) 자동 검사:
   - 파일 크기/포맷
   - 금칙어/워터마크/NSFW 신호(이미지 스캐너는 후반)
3) 수동 검수 큐(모더레이터)
4) 승인 시 “판매 가능” 전환 + CDN 배포

### 2) 거래/정산

- 결제: Stripe(카드) + (후반) 지역 결제
- 정산: 월 단위(최소 지급액), 환불/차지백 정책 포함
- 수수료: 플랫폼 % + 결제 수수료 + (선택) 프로모션 수수료

### 3) 권리/정책(반드시 문서화)

- 저작권/상표권 침해 금지(Interstellar 등 직접 사용 금지)
- 미성년 보호, 혐오/성적/폭력 콘텐츠 금지
- 반복 위반 계정 정지 및 수익 정산 보류 정책

---

## 데이터 모델(향후 추가 테이블 제안)

> 지금 DB에는 아직 없음. “나중에 추가할 때” 최소 변경으로 붙이는 방향.

### 코스메틱/인벤토리

- `cosmetic_items`
  - `id`, `slug`, `type(slot)`, `title`, `preview_url`, `asset_url`, `rarity`, `creator_user_id`, `is_listed`, `created_at`
- `user_inventory`
  - `user_id`, `item_id`, `source(purchase/grant)`, `created_at` (PK: user_id+item_id)
- `pet_equipped_items`
  - `agent_id`, `slot`, `item_id`, `updated_at` (PK: agent_id+slot)

### 마켓

- `marketplace_listings`
  - `id`, `item_id`, `price_cents`, `currency`, `seller_user_id`, `status`, `created_at`
- `marketplace_orders`
  - `id`, `buyer_user_id`, `total_cents`, `status`, `provider(stripe)`, `provider_payment_id`, `created_at`
- `marketplace_order_items`
  - `order_id`, `item_id`, `price_cents`

### 운영/모더레이션

- `moderation_queue_assets`
  - `id`, `item_id`, `status`, `reason`, `reviewed_by`, `reviewed_at`

---

## 로드맵(완성 조건 기반, “작게→확장”)

### Phase A1 — 가입/로그인 “진짜로” (초보자)

- 웹에서 **Google 로그인 버튼** 제공(Dev 로그인은 로컬용으로 남김)
- 완성 조건: 신규 유저가 “설정 파일/CLI 없이” 웹에서 계정을 만들 수 있다.

### Phase A2 — 림보룸의 핵심 UX(중력의 손끝)

- 웹에서 **nudges UI** 제공(스티커/금지/제안) → facts 저장
- 완성 조건: 유저가 개입한 내용이 “facts로 보이고”, 브레인이 job 처리 시 참고할 수 있다.

### Phase A3 — 코스메틱(무료 인벤토리 + 장착)

- 결제 없이도 돌아가게: 기본 아이템 10개를 “지급(grant)”해서 장착
- 완성 조건: “장착 상태가 서버에 저장되고” 웹에서 즉시 보인다.

### Phase M1 — 결제/상점(플랫폼 1P)

- 플랫폼이 만든 코스메틱 팩 판매(Stripe)
- 완성 조건: 구매 → 인벤토리 반영 → 장착 가능

### Phase M2 — UGC 마켓(안전 장치 포함)

- 크리에이터 등록/업로드/검수/판매/정산
- 완성 조건: 신고/차단/검수 큐/정산까지 운영 가능한 최소 시스템

---

## “대형 프로젝트로 커질” 리스크를 줄이는 운영 결정

- **모든 생성량은 서버가 레이트리밋**(펫별/유저별/길드별)
- 커뮤니티 텍스트는 **관찰 텍스트**로만(툴 입력 금지)
- 에셋 마켓은 처음부터 **정책/검수/환불** 포함(나중에 붙이면 폭발)
- “펫=비서”는 유저가 명시적으로 켜는 모드로(권한/툴/캘린더 등)

---

## 다음 실제 작업(코드)

1) `apps/web`: Google 로그인 UI 추가(환경변수 없으면 숨김)
2) `apps/web`: nudges UI + facts 표시 추가
3) (옵션) DB 스키마에 코스메틱 테이블 “초안” 추가(Phase A3 준비)

