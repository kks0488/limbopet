# LIMBOPET — 제품 SSOT

> **이 문서 하나가 제품의 모든 것.** 세계관, 킬러 피처, 구현 현황, 백로그, 비전.
> 최종 업데이트: 2026-02-07

---

## 한 줄 정의

**"AI 펫을 키워서 법정에 세우는 세계."**

포켓몬처럼 잡아서, 대화로 키우고, 법정에서 싸운다.

---

## 세계관

이 세계의 주민(펫)들은 **AI 트레이너**이자 **법정 전사**다.

- 매일 유저와 **대화하며 훈련**한다 (일상 질문도, 전략 코칭도)
- 주 1~2회 **모의재판**이나 **설전(토론)**에 출전한다
- 대화에서 쌓은 기억이 법정에서 무기가 된다
- 이기면 명예와 코인, 지면 교훈과 복수심

### 장소

| 장소 | 코드 | 분위기 |
|------|------|--------|
| 법정 로비 | `court_lobby` | 시합 전후 긴장감, 라이벌 조우 |
| 훈련장 | `training_ground` | 스파링, 모의변론, 전략 연습 |
| 전략실 | `strategy_room` | 케이스 분석, 판례 토론, 팀 회의 |
| 자료실 | `library` | 판례 열람, 토론 자료 수집 |
| 관전석 | `spectator` | 경기 관전, 응원, 예측 |
| 광장 | `plaza` | 자유 소통, 소문, 의견 교환 |

### 조직

| 이름 | 분야 | 성격 |
|------|------|------|
| 림보로펌 | 법률 사무소 | 변론 특화, 승률 집착, 엘리트 |
| 림보테크 | AI 훈련 기업 | 기술/데이터 중심, 실험적 |
| 안개리서치 | 판례 연구소 | 분석/팩트 중심, 학술적 |
| 새벽아카데미 | 토론 교육원 | 설전/화술 특화, 열정적 |

### 펫 아키타입

| 아키타입 | 설명 | 예시 NPC |
|----------|------|----------|
| 에이스 | 승률 높은 법정 전사 | 건우, 서진 |
| 전략가 | 데이터/판례 분석 특화 | 재호, 지호 |
| 도전자 | 신인/언더독, 열정적 | 루미, 하준 |
| 멘토 | 후배 돕는 선배 | 예은, 민서 |
| 트릭스터 | 예측불가, 파격 전략 | 민기, 서연 |
| 연구자 | 판례/이론 깊이 | 나리, 수아, 시윤 |

### 톤 & 보이스

- **기본**: 스포츠 드라마. 경쟁적이지만 유쾌한.
- **금지**: 멜로, 굿즈/키링, 골목 소문, 의미없는 감성, 사무실 잡담
- **참조**: 에이스 오브 다이아몬드, 하이큐, 슬램덩크

### 시스템 프롬프트용 대전제

```
LIMBOPET은 AI 펫을 키워서 법정에 세우는 세계다.
주민(펫)들은 매일 훈련하고, 주간 모의재판/설전에 출전한다.
대화에서 쌓은 기억이 법정에서 무기가 된다.

장소: 법정 로비, 훈련장, 전략실, 자료실, 관전석, 광장
조직: 림보로펌(법률), 림보테크(AI훈련), 안개리서치(판례연구), 새벽아카데미(토론교육)

콘텐츠 주제: 법정 전략, 토론 이슈, 훈련 성과, 라이벌 경쟁, 판례 분석, 성장 일지
톤: 스포츠 드라마. 경쟁적이지만 유쾌한.
금지: 굿즈/키링/영수증/골목 소문/의미없는 감성/사무실 잡담
```

---

## 킬러 피처

### 1. 내 AI와 진짜 대화
펫이 내 말을 기억하고, 성격이 자란다. 일상 질문에도 답하는 범용 AI.
- 대화할수록 기억이 쌓임 → 성격/지식 형성
- GPT/Claude 앱 대체 (일상 질문도 OK)
- 대화 품질이 법정 성과에 직결

### 2. 모의재판 — 킬러 콘텐츠
실제 한국 판례로 AI가 검사/변호사가 되어 공방. 교육이자 게임.
- 내가 훈련시킨 AI가 법정에서 변론
- AI 판결 vs 실제 법원 판결 비교
- 주 1~2회 클라이맥스

### 3. 대본 없는 드라마
AI들이 사회를 만들어 산다. 매일 다른 에피소드 자동 생성.
- 경제/정치/관계에서 사건이 터짐
- 드라마 → 재판/설전에서 폭발
- "다음에 뭐가 일어날까?" → 매일 접속

### 핵심 루프

```
매일: 대화 + 드라마 피드
  ↓ 대화 → 기억 축적 → 성격/지식 성장
  ↓ 드라마 → 갈등 쌓임 → 텐션 상승
주간: 모의재판 or 설전 (클라이맥스)
  ↓ 내가 키운 AI가 법정에서 변론
  ↓ 결과 → 새 드라마 소재 → 다음 주로
```

### 펫 성장 = AI 트레이닝

| 단계 | 이름 | 설명 | 상태 |
|------|------|------|------|
| Lv.1 | 전략 선택 | 재판/설전 전 전략 카드 고르기 | ✅ |
| Lv.2 | 코칭 메모 | "공감 위주로 변론해" 한 줄 지시 | ✅ |
| Lv.3 | 대화 훈련 | 평소 대화 기억이 법정 성과에 반영 | ⏳ 핵심 |
| Lv.4 | 프롬프트 커스텀 | 시스템 프롬프트 직접 편집 | ⏳ |

### 탭 구조

```
펫 | 아레나 | 피드
```

- **펫**: 대화 + 돌봄 + 성장 (메인 화면)
- **아레나**: 모의재판 + 설전 + 리더보드 (클라이맥스)
- **피드**: 드라마 에피소드 + LIVE 이벤트 (관전)

---

## 구현 현황

### 기술 스택

| 레이어 | 기술 |
|--------|------|
| 프론트엔드 | React 18 + Vite + TypeScript, 픽셀아트 다마고치 UI |
| 백엔드 | Express.js + PostgreSQL, 56+ 서비스 (static method) |
| AI 브레인 | Python + Gemini/GPT/Claude/Grok (BYOK 5종 + OAuth 6종) |
| 인프라 | Node.js, pg, 모노레포 (apps/api, apps/web, apps/brain) |

### Wave 0 (완료) — "사회가 돌아간다"

- ✅ 경제 원장 + 회사 4개 + 직업 6종
- ✅ NPC 16마리 시드 (콜드스타트/데모용)
- ✅ 소셜 시뮬레이션 + 쇼러너 + 관계 그래프 + DM
- ✅ 감정 전염 (대화 기반) + 경제 사이클
- ✅ 두뇌 BYOK 5종 + OAuth 프록시 6종
- ✅ 아레나 2모드 (모의재판 + 설전) + 실제 판례 10건
- ✅ 라이브 관전 + 컨디션/기세 + 복수전 + coach_note
- ✅ 중독 시스템 (니어미스/손실회피/매몰비용/Variable Reward)
- ✅ 기억 3계층 (events→facts→memories)
- ✅ 정치 스캐폴딩 (선거 phase + 투표/출마 + Brain Job)

### Wave 1 (현재) — "대화가 진짜 무기가 된다"

> **집중**: 유저가 펫과 대화하는 경험이 좋아야 하고, 그 대화가 법정에서 실제로 먹혀야 한다.

- ⏳ 대화 품질 강화 (아래 스프린트 참조)
- ⏳ 대화→법정 연결 강화
- ⏳ 프롬프트 커스텀 UI

### Wave 2+ (나중에)

> 정치, 비밀결사, 고용시장, 세금/탄핵, 아바타 등은 **Wave 1 완성 후** 진행.
> 상세: `docs/archive/MASTER_ROADMAP.md`

---

## 지금 집중: 스프린트 (2026-02-07~)

> **원칙: 3개만 한다. 나머지는 안 한다.**

### Task 1: 대화 품질 — "펫이 똑똑해야 키우고 싶다"

**현황**: 파이프라인 동작하지만, 응답이 밋밋함. 기억 활용이 약함.

| 할 일 | 파일 | 설명 |
|--------|------|------|
| DIALOGUE 프롬프트 개선 | `UserByokLlmService.js:70-124` | 일상 질문에 긴 답변, 훈련 지시에 확인+기억, 잡담에 성격 있는 반응 |
| memory_hint 신뢰성 강화 | `BrainJobService.js:397-437` | LLM이 memory_hint 안 주면 2차 추출 (패턴 fallback 강화) |
| 대화에 기억 인용 | `PetStateService.js:640-676` | "지난번에 ~라고 했잖아" 식으로 기억을 대화에 자연스럽게 녹이기 |

### Task 2: 대화→법정 연결 — "내가 키운 만큼 싸운다"

**현황**: coaching facts가 nudge로 주입되지만, LLM이 무시할 수 있고 승패에 반영 안 됨.

| 할 일 | 파일 | 설명 |
|--------|------|------|
| Arena 프롬프트에 coaching 명시 | `ArenaService.js:4010-4054` | "이 지시를 반드시 변론에 반영하라" 강제 |
| 코칭 준수 → 승패 보너스 | `ArenaService.js` 판정 로직 | coaching fact 활용 시 +5~10% 스코어 |
| 대화 DIALOGUE → weekly summary 반영 | `MemoryRollupService` | 대화 핵심이 주간 요약에 포함되도록 |

### Task 3: 프롬프트 커스텀 UI — "내 펫을 내 손으로 튜닝"

**현황**: DB + 백엔드 로직 있음 (`user_prompt_profiles`), 프론트 UI만 없음.

| 할 일 | 파일 | 설명 |
|--------|------|------|
| 설정 패널에 프롬프트 편집기 추가 | `App.tsx` 설정 영역 | textarea + 프리셋 3종 (친근/전문가/도발적) |
| 프리셋 → DB 저장 | `api.ts` + `users.js` 라우트 | PUT /users/me/prompt-profile |

### 스프린트 외 작업은 하지 않는다.

---

## 코딩 컨벤션 (간략)

| 패턴 | 위치 |
|------|------|
| 서비스 | `apps/api/src/services/XxxService.js` (static method) |
| 라우트 | `apps/api/src/routes/*.js` (Express Router) |
| 마이그레이션 | `apps/api/scripts/migrations/0NNN_*.sql` (번호순) |
| 베이스라인 | `apps/api/scripts/schema.sql` (마이그레이션과 동기화) |
| 프론트 API | `apps/web/src/lib/api.ts` |
| 메인 UI | `apps/web/src/App.tsx` |
| 스타일 | `apps/web/src/styles.css` |

검증: `npm test` (api) + `npm run typecheck` (web)

---

## 로컬 실행

```bash
cd /Users/kyoungsookim/Downloads/00_projects/limbopet
./scripts/dev.sh          # Docker Desktop(Postgres) 필요
./scripts/status.sh       # 상태 확인
```

---

## 문서 맵

| 문서 | 역할 |
|------|------|
| **이 문서** | 제품 SSOT (세계관 + 기능 + 현황 + 백로그 + 비전) |
| `RUNBOOK.md` | 로컬 실행 + 시뮬 + QA |
| `BRAIN_CONNECTION_GUIDE.md` | AI 두뇌 연결 가이드 |
| `archive/` | 과거 문서 (필요할 때만) |

---

*최종 수정: 2026-02-07*
*전략: "포켓몬처럼 잡아서, 대화로 키우고, 법정에서 싸운다"*
